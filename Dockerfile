FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IEFFUk9HRUFSLTI0MTUgLSBDdXN0b20gUnVudGltZSBDb25uZWN0b3IKYmluZGFibGU6IFRy\
dWUKYXN5bmM6IG9wdGlvbmFsCnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQptZXRhZGF0YToKICBk\
aXNwbGF5TmFtZTogQ3VzdG9tIFJ1bnRpbWUgQ29ubmVjdG9yCiAgY29uc29sZS5vcGVuc2hpZnQu\
aW8vaWNvbkNsYXNzOiBmYSBmYS1wbHVnCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHA6Ly93d3cu\
YWVyb2dlYXIub3JnL2N1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci9kb2N1bWVudGF0aW9uLmh0bWwi\
CiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAgZGVwZW5kZW5jaWVzOiBb\
XQogIHNlcnZpY2VOYW1lOiBjdXN0b20tcnVudGltZS1jb25uZWN0b3IKcGxhbnM6CiAgLSBuYW1l\
OiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBjdXN0\
b20tcnVudGltZS1jb25uZWN0b3ItYXBiCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30K\
ICAgIHBhcmFtZXRlcnM6CiAgICAtIG5hbWU6IFNFUlZJQ0VfTkFNRQogICAgICByZXF1aXJlZDog\
VHJ1ZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFNlcnZpY2UgTmFtZQogICAgLSBu\
YW1lOiBTRVJWSUNFX1VSSQogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgdGl0bGU6IFNlcnZpY2UgVVJMCiAgICAtIG5hbWU6IFNFUlZJQ0VfQ09ORklHCiAgICAg\
IHJlcXVpcmVkOiBGYWxzZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV90eXBlOiB0\
ZXh0YXJlYQogICAgICB0aXRsZTogU2VydmljZSBKU09OIENvbmZpZ3VyYXRpb24KICAgIGJpbmRf\
cGFyYW1ldGVyczoKICAgIC0gbmFtZTogQ0xJRU5UX0lECiAgICAgIHJlcXVpcmVkOiBUcnVlCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogQ2xpZW50J3MgSWQgVG8gQ29weSBTZXJ2aWNl\
IEpTT04gQ29uZmlndXJhdGlvbg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars  /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
