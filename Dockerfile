FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IEN1c3RvbSBSdW50aW1lIENvbm5lY3RvcgpiaW5kYWJsZTogVHJ1ZQphc3luYzogcmVxdWly\
ZWQKdGFnczoKICAtIG1vYmlsZS1zZXJ2aWNlCiAgLSBtb2JpbGUtY2xpZW50LWVuYWJsZWQKbWV0\
YWRhdGE6CiAgZGlzcGxheU5hbWU6IEN1c3RvbSBSdW50aW1lIENvbm5lY3RvcgogIGNvbnNvbGUu\
b3BlbnNoaWZ0LmlvL2ljb25DbGFzczogZmEgZmEtcGx1ZwogIGRvY3VtZW50YXRpb25Vcmw6ICJo\
dHRwOi8vd3d3LmFlcm9nZWFyLm9yZy9jdXN0b20tcnVudGltZS1jb25uZWN0b3IvZG9jdW1lbnRh\
dGlvbi5odG1sIgogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIGRlcGVu\
ZGVuY2llczogW10KICBzZXJ2aWNlTmFtZTogY3VzdG9tLXJ1bnRpbWUtY29ubmVjdG9yCnBsYW5z\
OgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgZGVmYXVsdCBwbGFuIGRl\
cGxveXMgY3VzdG9tLXJ1bnRpbWUtY29ubmVjdG9yLWFwYgogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6CiAgICAgIG1vYmlsZWNsaWVudF9iaW5kX3BhcmFtZXRlcnNfZGF0YToKICAgICAgICAt\
ICd7Im5hbWUiOiAiQ0xJRU5UX0lEIiwgInZhbHVlIjogIm1ldGFkYXRhLm5hbWUiLCAidHlwZSI6\
ICJwYXRoIn0nCiAgICBwYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBTRVJWSUNFX05BTUUKICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBTZXJ2aWNlIE5hbWUKICAgICAgcmVxdWlyZWQ6IFRy\
dWUKICAgIC0gbmFtZTogU0VSVklDRV9VUkkKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxl\
OiBTZXJ2aWNlIFVSTAogICAgICByZXF1aXJlZDogVHJ1ZQogICAgLSBuYW1lOiBTRVJWSUNFX0NP\
TkZJRwogICAgICBkZWZhdWx0OiAne30nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5\
X3R5cGU6IHRleHRhcmVhCiAgICAgIHRpdGxlOiBTZXJ2aWNlIEpTT04gQ29uZmlndXJhdGlvbgog\
ICAgICByZXF1aXJlZDogRmFsc2UKICAgIGJpbmRfcGFyYW1ldGVyczoKICAgIC0gbmFtZTogQ0xJ\
RU5UX0lECiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogTW9iaWxlIENsaWVudCBJRAog\
ICAgICByZXF1aXJlZDogVHJ1ZQo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars  /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
