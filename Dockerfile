FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IFJ1bnRpbWUgQ29ubmVjdG9yCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiByZXF1aXJlZAp0YWdz\
OgogIC0gbW9iaWxlLXNlcnZpY2UKICAtIG1vYmlsZS1jbGllbnQtZW5hYmxlZAptZXRhZGF0YToK\
ICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGZhIGZhLXBsdWcKICBkaXNwbGF5TmFt\
ZTogUnVudGltZSBDb25uZWN0b3IKICBkZXBlbmRlbmNpZXM6IFtdCiAgZG9jdW1lbnRhdGlvblVy\
bDogImh0dHA6Ly9kb2NzLmFlcm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvY3VzdG9tLXJ1bnRpbWUt\
Y29ubmVjdG9yLmh0bWwiCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAg\
c2RrLWRvY3MtYW5kcm9pZDogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmciCiAgc2RrLWRvY3Mt\
Y29yZG92YTogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmciCiAgc2RrLWRvY3MtaW9zOiAiaHR0\
cHM6Ly9kb2NzLmFlcm9nZWFyLm9yZyIKICBzZGstZG9jcy14YW1hcmluOiAiaHR0cHM6Ly9kb2Nz\
LmFlcm9nZWFyLm9yZyIKICBzZXJ2aWNlTmFtZTogY3VzdG9tLXJ1bnRpbWUtY29ubmVjdG9yCnBs\
YW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgZGVmYXVsdCBwbGFu\
IGRlcGxveXMgY3VzdG9tLXJ1bnRpbWUtY29ubmVjdG9yLWFwYgogICAgZnJlZTogVHJ1ZQogICAg\
bWV0YWRhdGE6CiAgICAgIG1vYmlsZWNsaWVudF9iaW5kX3BhcmFtZXRlcnNfZGF0YToKICAgICAg\
ICAtICd7Im5hbWUiOiAiQ0xJRU5UX0lEIiwgInZhbHVlIjogIm1ldGFkYXRhLm5hbWUiLCAidHlw\
ZSI6ICJwYXRoIn0nCiAgICBwYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBTRVJWSUNFX05BTUUKICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBTZXJ2aWNlIE5hbWUKICAgICAgcmVxdWlyZWQ6\
IFRydWUKICAgIC0gbmFtZTogU0VSVklDRV9VUkkKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRp\
dGxlOiBTZXJ2aWNlIFVSTAogICAgICByZXF1aXJlZDogVHJ1ZQogICAgLSBuYW1lOiBTRVJWSUNF\
X0NPTkZJRwogICAgICBkZWZhdWx0OiAne30nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNw\
bGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIHRpdGxlOiBTZXJ2aWNlIEpTT04gQ29uZmlndXJhdGlv\
bgogICAgICByZXF1aXJlZDogRmFsc2UKICAgIGJpbmRfcGFyYW1ldGVyczoKICAgIC0gbmFtZTog\
Q0xJRU5UX0lECiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogTW9iaWxlIENsaWVudCBJ\
RAogICAgICByZXF1aXJlZDogVHJ1ZQo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars  /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
